<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RevAcad.IA - Revis√£o Acad√™mica Inteligente</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/lucide/0.263.1/lucide.min.css" rel="stylesheet">
    <script src="https://unpkg.com/lucide@latest/dist/umd/lucide.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap');
        body { font-family: 'Inter', sans-serif; }
        .animate-pulse { animation: pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite; }
        @keyframes pulse { 0%, 100% { opacity: 1; } 50% { opacity: .5; } }
    </style>
</head>
<body class="bg-gray-50">
    <div id="app"></div>

    <script>
        // Document Analyzer Class
        class DocumentAnalyzer {
            constructor() {
                this.methodologyKeywords = [
                    'metodologia', 'm√©todo', 'amostra', 'popula√ß√£o', 'coleta', 'dados', 'an√°lise',
                    'estat√≠stica', 'qualitativo', 'quantitativo', 'entrevista', 'question√°rio',
                    'observa√ß√£o', 'experimento', 'survey', 'estudo de caso', 'etnografia'
                ];
                
                this.ethicsKeywords = [
                    '√©tica', 'consentimento', 'tcle', 'comit√™', 'cep', 'privacidade', 'anonimato',
                    'confidencialidade', 'riscos', 'benef√≠cios', 'volunt√°rio', 'aprova√ß√£o'
                ];
                
                this.clarityIndicators = {
                    academic: ['portanto', 'todavia', 'contudo', 'outrossim', 'ademais', 'destarte'],
                    connectors: ['porque', 'pois', 'logo', 'assim', 'ent√£o', 'desta forma'],
                    precision: ['espec√≠fico', 'preciso', 'exato', 'detalhado', 'rigoroso']
                };
            }

            analyzeText(text) {
                const textLower = text.toLowerCase();
                const sentences = text.split(/[.!?]+/).filter(s => s.trim().length > 10);
                const words = textLower.split(/\s+/);
                const paragraphs = text.split(/\n\s*\n/).filter(p => p.trim().length > 0);
                
                return {
                    wordCount: words.length,
                    sentenceCount: sentences.length,
                    paragraphCount: paragraphs.length,
                    avgSentenceLength: words.length / sentences.length,
                    methodology: this.analyzeMethodology(textLower, sentences),
                    ethics: this.analyzeEthics(textLower, sentences),
                    clarity: this.analyzeClarity(textLower, sentences),
                    references: this.countReferences(text),
                    citations: this.analyzeCitations(text)
                };
            }

            analyzeMethodology(text, sentences) {
                const methodMatches = this.methodologyKeywords.filter(word => text.includes(word));
                const hasMethodSection = /metodologia|m√©todo/i.test(text);
                const hasSampleDescription = /amostra|popula√ß√£o|participantes/i.test(text);
                const hasDataCollection = /coleta|dados|instrumento/i.test(text);
                
                const score = (methodMatches.length / this.methodologyKeywords.length) * 100;
                
                const feedback = [];
                if (!hasMethodSection) feedback.push("Se√ß√£o de metodologia n√£o identificada");
                if (!hasSampleDescription) feedback.push("Descri√ß√£o da amostra precisa ser detalhada");
                if (!hasDataCollection) feedback.push("Procedimentos de coleta devem ser explicitados");
                
                const strengths = [];
                if (hasMethodSection) strengths.push("Se√ß√£o metodol√≥gica presente");
                if (methodMatches.length > 5) strengths.push("Vocabul√°rio metodol√≥gico adequado");

                return { score, feedback, strengths, coverage: methodMatches.length };
            }

            analyzeEthics(text, sentences) {
                const ethicsMatches = this.ethicsKeywords.filter(word => text.includes(word));
                const hasEthicsCommittee = /cep|comit√™.*√©tica|aprova√ß√£o.*√©tica/i.test(text);
                const hasConsent = /tcle|consentimento|termo/i.test(text);
                
                const score = Math.min((ethicsMatches.length / 3) * 100, 100);
                
                const feedback = [];
                if (!hasEthicsCommittee) feedback.push("Aprova√ß√£o do CEP deve ser mencionada");
                if (!hasConsent) feedback.push("TCLE deve ser documentado");
                
                const strengths = [];
                if (hasEthicsCommittee) strengths.push("Aprova√ß√£o √©tica documentada");
                if (hasConsent) strengths.push("Consentimento informado considerado");

                return { score, feedback, strengths, hasCommittee: hasEthicsCommittee };
            }

            analyzeClarity(text, sentences) {
                const avgSentenceLength = sentences.reduce((sum, s) => sum + s.split(' ').length, 0) / sentences.length;
                const academicConnectors = this.clarityIndicators.academic.filter(word => text.includes(word)).length;
                const logicalConnectors = this.clarityIndicators.connectors.filter(word => text.includes(word)).length;
                
                const clarityScore = (
                    (avgSentenceLength < 25 ? 30 : Math.max(0, 30 - (avgSentenceLength - 25))) +
                    Math.min(academicConnectors * 5, 25) +
                    Math.min(logicalConnectors * 5, 25) +
                    20
                );
                
                const feedback = [];
                if (avgSentenceLength > 30) feedback.push("Frases muito longas - considere dividir");
                if (academicConnectors < 3) feedback.push("Use mais conectivos acad√™micos");
                
                const strengths = [];
                if (avgSentenceLength < 20) strengths.push("Frases concisas");
                if (academicConnectors > 5) strengths.push("Bom uso de conectivos acad√™micos");

                return { 
                    score: clarityScore, 
                    feedback, 
                    strengths, 
                    avgSentenceLength,
                    connectorsUsed: academicConnectors + logicalConnectors
                };
            }

            countReferences(text) {
                const refs = (text.match(/\([^)]*\d{4}[^)]*\)/g) || []).length;
                return { total: refs };
            }

            analyzeCitations(text) {
                const citations = text.match(/\([^)]*\d{4}[^)]*\)/g) || [];
                const recentCitations = citations.filter(cite => {
                    const years = cite.match(/20[12][0-9]/g);
                    return years && years.some(year => parseInt(year) > 2020);
                });
                
                return {
                    total: citations.length,
                    recent: recentCitations.length,
                    recencyScore: citations.length > 0 ? (recentCitations.length / citations.length) * 100 : 0
                };
            }
        }

        // App State
        let appState = {
            currentStep: 'home',
            uploadedFile: null,
            userName: '',
            documentType: 'artigo',
            analysisResult: null,
            reviewProgress: 0
        };

        // Sample texts
        const sampleTexts = {
            artigo: `RESUMO
Este estudo investiga metodologia qualitativa aplicada √† an√°lise de dados educacionais no contexto brasileiro. O objetivo foi examinar as pr√°ticas pedag√≥gicas atrav√©s de entrevistas semiestruturadas com 30 professores. A coleta de dados ocorreu ap√≥s aprova√ß√£o do Comit√™ de √âtica em Pesquisa (CEP). Os participantes assinaram o Termo de Consentimento Livre e Esclarecido (TCLE), garantindo privacidade. Os resultados indicam que 67% dos professores utilizam metodologias ativas. A an√°lise tem√°tica revelou tr√™s categorias principais. Portanto, conclui-se que pol√≠ticas p√∫blicas devem priorizar a forma√ß√£o docente. As limita√ß√µes incluem a amostra restrita.

METODOLOGIA
Esta pesquisa adotou abordagem qualitativa. A popula√ß√£o consistiu em professores da rede p√∫blica. A amostra foi composta por 30 professores, selecionados por conveni√™ncia. O instrumento de coleta foi uma entrevista semiestruturada com 15 quest√µes abertas. As entrevistas duraram em m√©dia 45 minutos e foram gravadas com consentimento. O tratamento dos dados seguiu an√°lise tem√°tica.

REFER√äNCIAS
Silva, A. (2023). Educa√ß√£o brasileira. Revista de Ensino, 45(2), 123-145.
Santos, B. (2024). Metodologias ativas. Educa√ß√£o & Pesquisa, 49(1), 67-89.`,
            dissertacao: `RESUMO
Esta disserta√ß√£o examina estrat√©gias de ensino-aprendizagem em cursos de Engenharia no Brasil. O objetivo foi analisar como professores universit√°rios aplicam metodologias ativas. A pesquisa utilizou abordagem mista, com question√°rios (n=150) e entrevistas (n=20). A coleta ocorreu ap√≥s aprova√ß√£o dos Comit√™s de √âtica das institui√ß√µes. Todos assinaram TCLE, garantindo confidencialidade. Os dados quantitativos foram tratados com estat√≠stica descritiva. Os resultados mostram que 78% conhecem metodologias ativas, mas apenas 34% implementam. As barreiras foram: turmas numerosas (89%), carga hor√°ria (76%). Contudo, 92% manifestaram interesse em capacita√ß√£o. Conclui-se que a implementa√ß√£o requer apoio institucional sistem√°tico.`
        };

        // Render functions
        function renderHome() {
            return `
                <div class="min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100">
                    <header class="bg-white shadow-sm border-b">
                        <div class="max-w-6xl mx-auto px-4 py-4 flex justify-between items-center">
                            <div class="flex items-center gap-2">
                                <i data-lucide="book-open" class="w-8 h-8 text-indigo-600"></i>
                                <h1 class="text-xl font-bold text-gray-900">RevAcad.IA</h1>
                            </div>
                            <button onclick="goToStep('upload')" class="bg-indigo-600 text-white px-6 py-2 rounded-lg hover:bg-indigo-700 transition-colors">
                                Come√ßar Revis√£o
                            </button>
                        </div>
                    </header>

                    <section class="max-w-6xl mx-auto px-4 py-16 text-center">
                        <h2 class="text-4xl font-bold text-gray-900 mb-4">
                            Revis√£o Acad√™mica Inteligente
                            <span class="block text-indigo-600">Para Orientadores e Pesquisadores</span>
                        </h2>
                        <p class="text-xl text-gray-600 mb-8 max-w-3xl mx-auto">
                            An√°lise profunda de metodologia, √©tica e clareza argumentativa.
                            Feedback detalhado para manuscritos acad√™micos brasileiros.
                        </p>
                        
                        <div class="grid md:grid-cols-4 gap-6 mb-12">
                            <div class="bg-white p-6 rounded-xl shadow-sm border">
                                <i data-lucide="bar-chart-3" class="w-12 h-12 text-blue-600 mx-auto mb-4"></i>
                                <h3 class="font-semibold text-lg mb-2">An√°lise Metodol√≥gica</h3>
                                <p class="text-gray-600">Avalia√ß√£o de rigor cient√≠fico</p>
                            </div>
                            <div class="bg-white p-6 rounded-xl shadow-sm border">
                                <i data-lucide="shield" class="w-12 h-12 text-green-600 mx-auto mb-4"></i>
                                <h3 class="font-semibold text-lg mb-2">√âtica de Pesquisa</h3>
                                <p class="text-gray-600">Verifica√ß√£o CEP e TCLE</p>
                            </div>
                            <div class="bg-white p-6 rounded-xl shadow-sm border">
                                <i data-lucide="file-text" class="w-12 h-12 text-purple-600 mx-auto mb-4"></i>
                                <h3 class="font-semibold text-lg mb-2">Clareza Textual</h3>
                                <p class="text-gray-600">Coes√£o e argumenta√ß√£o</p>
                            </div>
                            <div class="bg-white p-6 rounded-xl shadow-sm border">
                                <i data-lucide="target" class="w-12 h-12 text-red-600 mx-auto mb-4"></i>
                                <h3 class="font-semibold text-lg mb-2">Feedback Acion√°vel</h3>
                                <p class="text-gray-600">Sugest√µes espec√≠ficas</p>
                            </div>
                        </div>

                        <button onclick="goToStep('upload')" class="bg-indigo-600 text-white px-8 py-3 rounded-lg text-lg hover:bg-indigo-700 transition-colors shadow-lg">
                            Analisar Documento Gratuitamente
                        </button>
                    </section>
                </div>
            `;
        }

        function renderUpload() {
            return `
                <div class="min-h-screen bg-gray-50">
                    <header class="bg-white shadow-sm border-b">
                        <div class="max-w-4xl mx-auto px-4 py-4 flex items-center gap-4">
                            <button onclick="goToStep('home')" class="text-indigo-600 hover:text-indigo-700">‚Üê Voltar</button>
                            <i data-lucide="book-open" class="w-6 h-6 text-indigo-600"></i>
                            <h1 class="text-lg font-semibold">RevAcad.IA</h1>
                        </div>
                    </header>

                    <div class="max-w-4xl mx-auto px-4 py-8">
                        <div class="bg-white rounded-xl shadow-sm border p-8">
                            <h2 class="text-2xl font-semibold mb-6 text-center">Configure sua an√°lise</h2>
                            
                            <div class="grid md:grid-cols-2 gap-6 mb-6">
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Seu nome</label>
                                    <input type="text" id="userName" placeholder="Prof. Dr. Jo√£o Silva" 
                                           class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent">
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Tipo de documento</label>
                                    <select id="documentType" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent">
                                        <option value="artigo">Artigo Cient√≠fico</option>
                                        <option value="dissertacao">Disserta√ß√£o</option>
                                        <option value="tcc">TCC/Monografia</option>
                                    </select>
                                </div>
                            </div>

                            <div class="mb-6">
                                <label class="block text-sm font-medium text-gray-700 mb-2">Documento (PDF ou DOCX)</label>
                                <div class="border-2 border-dashed border-gray-300 rounded-lg p-8 text-center">
                                    <input type="file" accept=".pdf,.docx,.doc,.txt" id="fileInput" class="hidden" onchange="handleFileUpload(event)">
                                    <div id="fileDisplay" onclick="document.getElementById('fileInput').click()" class="cursor-pointer">
                                        <i data-lucide="upload" class="w-12 h-12 text-gray-400 mx-auto mb-4"></i>
                                        <p class="text-lg text-gray-600 mb-2">Clique para selecionar arquivo</p>
                                        <p class="text-sm text-gray-500">PDF, DOC, DOCX ou TXT ‚Ä¢ Para demonstra√ß√£o, usaremos texto simulado</p>
                                    </div>
                                </div>
                            </div>

                            <div class="text-center">
                                <button onclick="startAnalysis()" id="startBtn" disabled 
                                        class="px-8 py-3 rounded-lg text-lg font-medium bg-gray-300 text-gray-500 cursor-not-allowed">
                                    Iniciar An√°lise
                                </button>
                            </div>

                            <div class="mt-6 text-xs text-gray-500 text-center">
                                üîí An√°lise local - documento n√£o enviado para servidores
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }

        function renderReviewing() {
            const currentPhase = 
                appState.reviewProgress < 30 ? 'Analisando estrutura e metodologia' :
                appState.reviewProgress < 60 ? 'Verificando aspectos √©ticos' :
                appState.reviewProgress < 90 ? 'Avaliando clareza textual' :
                'Gerando relat√≥rio personalizado';

            return `
                <div class="min-h-screen bg-gray-50">
                    <header class="bg-white shadow-sm border-b">
                        <div class="max-w-4xl mx-auto px-4 py-4 flex items-center gap-4">
                            <i data-lucide="book-open" class="w-6 h-6 text-indigo-600"></i>
                            <h1 class="text-lg font-semibold">RevAcad.IA</h1>
                            <span class="text-sm text-gray-500">Analisando ${appState.documentType}</span>
                        </div>
                    </header>

                    <div class="max-w-4xl mx-auto px-4 py-8">
                        <div class="bg-white rounded-xl shadow-sm border p-8 text-center">
                            <div class="mb-6">
                                <i data-lucide="clock" class="w-16 h-16 text-indigo-600 mx-auto mb-4 animate-pulse"></i>
                                <h2 class="text-2xl font-semibold mb-2">Analisando seu ${appState.documentType}${appState.userName ? `, ${appState.userName}` : ''}...</h2>
                                <p class="text-gray-600 mb-2">${currentPhase}</p>
                            </div>

                            <div class="mb-6">
                                <div class="w-full bg-gray-200 rounded-full h-3 mb-2">
                                    <div class="bg-indigo-600 h-3 rounded-full transition-all duration-500" 
                                         style="width: ${Math.min(appState.reviewProgress, 100)}%"></div>
                                </div>
                                <p class="text-sm text-gray-600">${Math.round(appState.reviewProgress)}% conclu√≠do</p>
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }

        function renderComplete() {
            if (!appState.analysisResult) return '';

            const result = appState.analysisResult;
            const overallScore = Math.round((result.methodology.score + result.ethics.score + result.clarity.score) / 3);

            return `
                <div class="min-h-screen bg-gray-50">
                    <header class="bg-white shadow-sm border-b">
                        <div class="max-w-6xl mx-auto px-4 py-4 flex justify-between items-center">
                            <div class="flex items-center gap-4">
                                <i data-lucide="book-open" class="w-6 h-6 text-indigo-600"></i>
                                <h1 class="text-lg font-semibold">RevAcad.IA - Relat√≥rio Completo</h1>
                            </div>
                            <div class="flex gap-3">
                                <button onclick="resetApp()" class="text-indigo-600 hover:text-indigo-700 px-4 py-2">Nova An√°lise</button>
                                <button onclick="downloadReport()" class="bg-indigo-600 text-white px-4 py-2 rounded-lg hover:bg-indigo-700">Baixar Relat√≥rio</button>
                            </div>
                        </div>
                    </header>

                    <div class="max-w-6xl mx-auto px-4 py-8">
                        <!-- Header do Relat√≥rio -->
                        <div class="bg-gradient-to-r from-indigo-500 to-purple-600 text-white rounded-xl p-8 mb-8">
                            <div class="flex justify-between items-start">
                                <div>
                                    <h2 class="text-3xl font-bold mb-2">Relat√≥rio de An√°lise${appState.userName ? ` - ${appState.userName}` : ''}</h2>
                                    <p class="text-indigo-100 mb-4">Documento: ${appState.documentType.charAt(0).toUpperCase() + appState.documentType.slice(1)}</p>
                                    <div class="flex gap-6 text-sm">
                                        <span>üìù ${result.wordCount.toLocaleString()} palavras</span>
                                        <span>üìÑ ${result.paragraphCount} par√°grafos</span>
                                        <span>üìö ${result.references.total} refer√™ncias</span>
                                    </div>
                                </div>
                                <div class="text-right">
                                    <div class="text-4xl font-bold mb-2">${overallScore}/100</div>
                                    <p class="text-indigo-100">Pontua√ß√£o Geral</p>
                                </div>
                            </div>
                        </div>

                        <!-- Scores -->
                        <div class="grid md:grid-cols-3 gap-6 mb-8">
                            <div class="bg-white rounded-xl shadow-sm border p-6">
                                <div class="flex items-center justify-between mb-4">
                                    <i data-lucide="bar-chart-3" class="w-8 h-8 text-blue-600"></i>
                                    <span class="text-2xl font-bold ${result.methodology.score > 70 ? 'text-green-600' : result.methodology.score > 50 ? 'text-yellow-600' : 'text-red-600'}">
                                        ${Math.round(result.methodology.score)}
                                    </span>
                                </div>
                                <h3 class="font-semibold text-lg mb-2">Metodologia</h3>
                                <p class="text-gray-600 text-sm">${result.methodology.coverage}/17 termos encontrados</p>
                            </div>

                            <div class="bg-white rounded-xl shadow-sm border p-6">
                                <div class="flex items-center justify-between mb-4">
                                    <i data-lucide="shield" class="w-8 h-8 text-green-600"></i>
                                    <span class="text-2xl font-bold ${result.ethics.score > 70 ? 'text-green-600' : result.ethics.score > 50 ? 'text-yellow-600' : 'text-red-600'}">
                                        ${Math.round(result.ethics.score)}
                                    </span>
                                </div>
                                <h3 class="font-semibold text-lg mb-2">√âtica</h3>
                                <p class="text-gray-600 text-sm">${result.ethics.hasCommittee ? 'CEP identificado' : 'CEP n√£o mencionado'}</p>
                            </div>

                            <div class="bg-white rounded-xl shadow-sm border p-6">
                                <div class="flex items-center justify-between mb-4">
                                    <i data-lucide="file-text" class="w-8 h-8 text-purple-600"></i>
                                    <span class="text-2xl font-bold ${result.clarity.score > 70 ? 'text-green-600' : result.clarity.score > 50 ? 'text-yellow-600' : 'text-red-600'}">
                                        ${Math.round(result.clarity.score)}
                                    </span>
                                </div>
                                <h3 class="font-semibold text-lg mb-2">Clareza</h3>
                                <p class="text-gray-600 text-sm">${Math.round(result.clarity.avgSentenceLength)} palavras/frase</p>
                            </div>
                        </div>

                        <!-- Metodologia Transparente -->
                        <div class="bg-white rounded-xl shadow-sm border p-8 mb-8">
                            <h3 class="text-2xl font-semibold mb-6 flex items-center gap-3">
                                <i data-lucide="users" class="w-8 h-8 text-blue-600"></i>
                                Como Esta An√°lise Foi Feita
                            </h3>

                            <div class="grid md:grid-cols-3 gap-6">
                                <div class="bg-blue-50 p-6 rounded-lg">
                                    <h4 class="font-semibold text-lg mb-4 text-blue-800">üîç Metodologia (${Math.round(result.methodology.score)}/100)</h4>
                                    <div class="text-sm text-blue-700 space-y-2">
                                        <p><strong>Busca por:</strong></p>
                                        <ul class="list-disc list-inside space-y-1 text-xs">
                                            <li>${result.methodology.coverage}/17 palavras-chave encontradas</li>
                                            <li>Se√ß√£o metodologia presente ‚úÖ</li>
                                        </ul>
                                        <div class="text-xs mt-2 p-2 bg-white rounded">
                                            <strong>F√≥rmula:</strong> (termos encontrados √∑ 17) √ó 100
                                        </div>
                                    </div>
                                </div>

                                <div class="bg-green-50 p-6 rounded-lg">
                                    <h4 class="font-semibold text-lg mb-4 text-green-800">üõ°Ô∏è √âtica (${Math.round(result.ethics.score)}/100)</h4>
                                    <div class="text-sm text-green-700 space-y-2">
                                        <p><strong>Checklist obrigat√≥rio:</strong></p>
                                        <ul class="list-disc list-inside space-y-1 text-xs">
                                            <li>CEP mencionado ${result.ethics.hasCommittee ? '‚úÖ +40pts' : '‚ùå 0pts'}</li>
                                            <li>TCLE presente ${result.ethics.strengths.some(s => s.includes('consentimento')) ? '‚úÖ +30pts' : '‚ùå 0pts'}</li>
                                        </ul>
                                    </div>
                                </div>

                                <div class="bg-purple-50 p-6 rounded-lg">
                                    <h4 class="font-semibold text-lg mb-4 text-purple-800">‚úçÔ∏è Clareza (${Math.round(result.clarity.score)}/100)</h4>
                                    <div class="text-sm text-purple-700 space-y-2">
                                        <p><strong>M√©tricas:</strong></p>
                                        <ul class="list-disc list-inside space-y-1 text-xs">
                                            <li>${Math.round(result.clarity.avgSentenceLength)} palavras/frase</li>
                                            <li>${result.clarity.connectorsUsed} conectivos usados</li>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Recomenda√ß√µes -->
                        <div class="bg-gradient-to-r from-indigo-500 to-purple-600 text-white rounded-xl p-8">
                            <h3 class="text-2xl font-semibold mb-6">üéØ Recomenda√ß√µes para Orienta√ß√£o</h3>
                            
                            <div class="grid md:grid-cols-2 gap-8">
                                <div>
                                    <h4 class="font-semibold text-lg mb-4">Prioridades Imediatas:</h4>
                                    <ul class="space-y-2 text-indigo-100 text-sm">
                                        ${result.methodology.score < 60 ? '<li>‚Ä¢ Revisar se√ß√£o metodol√≥gica</li>' : ''}
                                        ${result.ethics.score < 50 ? '<li>‚Ä¢ Explicitar aspectos √©ticos</li>' : ''}
                                        ${result.clarity.avgSentenceLength > 30 ? '<li>‚Ä¢ Simplificar frases</li>' : ''}
                                        ${result.methodology.score >= 60 && result.ethics.score >= 50 && result.clarity.avgSentenceLength <= 30 ? '<li>‚Ä¢ Documento em bom n√≠vel!</li>' : ''}
                                    </ul>
                                </div>
                                <div>
                                    <h4 class="font-semibold text-lg mb-4">Melhorias Gerais:</h4>
                                    <ul class="space-y-2 text-indigo-100 text-sm">
                                        <li>‚Ä¢ Verificar formata√ß√£o ABNT</li>
                                        <li>‚Ä¢ Fortalecer transi√ß√µes</li>
                                        <li>‚Ä¢ Considerar limita√ß√µes</li>
                                        <li>‚Ä¢ Revisar coes√£o</li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }

        // Event handlers
        function goToStep(step) {
            appState.currentStep = step;
            render();
        }

        function handleFileUpload(event) {
            const file = event.target.files[0];
            if (file) {
                appState.uploadedFile = file;
                document.getElementById('fileDisplay').innerHTML = `
                    <div class="flex items-center justify-center gap-2 text-green-600">
                        <i data-lucide="file-text" class="w-8 h-8"></i>
                        <div>
                            <p class="font-medium">${file.name}</p>
                            <p class="text-sm text-gray-500">Arquivo carregado - usando texto simulado para demonstra√ß√£o</p>
                        </div>
                    </div>
                `;
                updateStartButton();
            }
        }

        function updateStartButton() {
            const userName = document.getElementById('userName')?.value || '';
            const hasFile = appState.uploadedFile !== null;
            const btn = document.getElementById('startBtn');
            
            if (btn) {
                if (userName && hasFile) {
                    btn.disabled = false;
                    btn.className = 'px-8 py-3 rounded-lg text-lg font-medium bg-indigo-600 text-white hover:bg-indigo-700 cursor-pointer';
                    btn.textContent = 'Iniciar An√°lise Profunda';
                } else {
                    btn.disabled = true;
                    btn.className = 'px-8 py-3 rounded-lg text-lg font-medium bg-gray-300 text-gray-500 cursor-not-allowed';
                }
            }
        }

        function startAnalysis() {
            appState.userName = document.getElementById('userName').value;
            appState.documentType = document.getElementById('documentType').value;
            appState.currentStep = 'reviewing';
            appState.reviewProgress = 0;
            render();

            // Simular progresso
            const interval = setInterval(() => {
                appState.reviewProgress += Math.random() * 15;
                if (appState.reviewProgress >= 100) {
                    clearInterval(interval);
                    
                    // Fazer an√°lise real
                    const analyzer = new DocumentAnalyzer();
                    const sampleText = sampleTexts[appState.documentType] || sampleTexts.artigo;
                    appState.analysisResult = analyzer.analyzeText(sampleText);
                    
                    appState.currentStep = 'complete';
                    render();
                } else {
                    render();
                }
            }, 800);
        }

        function resetApp() {
            appState = {
                currentStep: 'home',
                uploadedFile: null,
                userName: '',
                documentType: 'artigo',
                analysisResult: null,
                reviewProgress: 0
            };
            render();
        }

        function downloadReport() {
            if (!appState.analysisResult) return;

            const reportContent = generateReportText();
            
            try {
                const blob = new Blob([reportContent], { type: 'text/plain;charset=utf-8' });
                const url = URL.createObjectURL(blob);
                const link = document.createElement('a');
                link.href = url;
                link.download = `relatorio-revisao-${appState.documentType}-${new Date().toISOString().split('T')[0]}.txt`;
                link.style.display = 'none';
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);
                URL.revokeObjectURL(url);
                alert('‚úÖ Relat√≥rio baixado com sucesso!');
            } catch (error) {
                try {
                    navigator.clipboard.writeText(reportContent);
                    alert('üìã Relat√≥rio copiado para √°rea de transfer√™ncia! Cole em um arquivo .txt');
                } catch (clipError) {
                    alert('‚ùå Erro no download. Tente novamente ou use outro navegador.');
                }
            }
        }

        function generateReportText() {
            const result = appState.analysisResult;
            const overallScore = Math.round((result.methodology.score + result.ethics.score + result.clarity.score) / 3);
            const date = new Date().toLocaleDateString('pt-BR');
            
            return `‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
                    RELAT√ìRIO DE REVIS√ÉO ACAD√äMICA
                            RevAcad.IA
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

üìã INFORMA√á√ïES GERAIS
‚Ä¢ Data da an√°lise: ${date}
‚Ä¢ Tipo de documento: ${appState.documentType.charAt(0).toUpperCase() + appState.documentType.slice(1)}
‚Ä¢ Analisado por: ${appState.userName || 'Usu√°rio'}

üìä ESTAT√çSTICAS DO DOCUMENTO
‚Ä¢ Palavras: ${result.wordCount.toLocaleString()}
‚Ä¢ Par√°grafos: ${result.paragraphCount}
‚Ä¢ Frases: ${result.sentenceCount}
‚Ä¢ Refer√™ncias: ${result.references.total}

üéØ PONTUA√á√ÉO GERAL: ${overallScore}/100

‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
                    AN√ÅLISE METODOL√ìGICA (${Math.round(result.methodology.score)}/100)
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

‚úÖ PONTOS FORTES:
${result.methodology.strengths.length > 0 ? 
  result.methodology.strengths.map(s => `‚Ä¢ ${s}`).join('\n') : 
  '‚Ä¢ An√°lise autom√°tica em desenvolvimento'}

‚ö†Ô∏è  RECOMENDA√á√ïES:
${result.methodology.feedback.length > 0 ? 
  result.methodology.feedback.map(f => `‚Ä¢ ${f}`).join('\n') : 
  '‚Ä¢ Metodologia adequada'}

‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
                    ASPECTOS √âTICOS (${Math.round(result.ethics.score)}/100)
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

üìã CHECKLIST √âTICO:
‚Ä¢ CEP: ${result.ethics.hasCommittee ? '‚úÖ Identificado' : '‚ùå N√£o mencionado'}
‚Ä¢ TCLE: ${result.ethics.strengths.some(s => s.includes('consentimento')) ? '‚úÖ Presente' : '‚ùå Ausente'}

‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
                    CLAREZA TEXTUAL (${Math.round(result.clarity.score)}/100)
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

üìà M√âTRICAS:
‚Ä¢ Palavras por frase: ${Math.round(result.clarity.avgSentenceLength)}
‚Ä¢ Conectivos usados: ${result.clarity.connectorsUsed}
‚Ä¢ Refer√™ncias recentes: ${result.citations.recencyScore.toFixed(0)}%

‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
                    RECOMENDA√á√ïES FINAIS
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

üéØ Este ${appState.documentType} apresenta ${overallScore > 70 ? 'boa' : overallScore > 50 ? 'moderada' : 'limitada'} adequa√ß√£o aos padr√µes acad√™micos brasileiros.

üìù Prioridades:
${result.methodology.score < 60 ? '‚Ä¢ Revisar metodologia\n' : ''}${result.ethics.score < 50 ? '‚Ä¢ Explicitar aspectos √©ticos\n' : ''}${result.clarity.avgSentenceLength > 30 ? '‚Ä¢ Simplificar frases\n' : ''}

Gerado em: ${date}
RevAcad.IA - Revis√£o Acad√™mica Inteligente (GitHub Pages)
            `;
        }

        // Main render function
        function render() {
            let content = '';
            
            switch (appState.currentStep) {
                case 'home':
                    content = renderHome();
                    break;
                case 'upload':
                    content = renderUpload();
                    break;
                case 'reviewing':
                    content = renderReviewing();
                    break;
                case 'complete':
                    content = renderComplete();
                    break;
            }
            
            document.getElementById('app').innerHTML = content;
            lucide.createIcons();
            
            // Add event listeners for upload page
            if (appState.currentStep === 'upload') {
                const userNameInput = document.getElementById('userName');
                if (userNameInput) {
                    userNameInput.addEventListener('input', updateStartButton);
                }
            }
        }

        // Initialize app
        document.addEventListener('DOMContentLoaded', () => {
            render();
        });
    </script>
</body>
</html>
